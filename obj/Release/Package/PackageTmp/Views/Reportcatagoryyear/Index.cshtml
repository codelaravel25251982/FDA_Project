@model IEnumerable<BeyondThemes.BeyondAdmin.Models.Reportcatagoryyear.ReportcatagoryyearView>
@using Microsoft.Reporting.WebForms;
@using MvcReportViewer;
@{
    ViewBag.Title = "รายงานแยกตามประเภทรายเดือน";
    Layout = "~/Views/Shared/_Default.cshtml";
}
<div class="row">
    <div class="col-lg-12 col-sm-12 col-xs-12">
        <div class="widget">
            <div class="widget-header bordered-left bordered-palegreen bg-success">
                <span class="widget-caption">ค้นหารรายงานแยกตามประเภทบริการประจำปี</span>
            </div>
            <div class="widget-body bordered-left bordered-palegreen">

                <form class="form-inline" id="accountForm">
                    ปี : <select name="year" class="form-control input-sm">
                        @for (int i = 1900 + 543; i <= 2090 + 543; i++)
                        {
                            if (DateTime.Now.Year == (i - 543))
                            {
                                <option selected value=@i>@i </option>
                            }
                            else
                            {
                                <option value=@i>@i </option>
                            }

                        }
                    </select>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">Search</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<div class="well with-header  with-footer">
    <div class="header bg-success">
        แสดงรายงานแยกตามประเภทปรจำปี
    </div>
    <table class="table table-striped table-bordered dt-responsive nowrap table-condensed" id="Rcm">
        <thead class="bordered-palegreen">
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.H_Date)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.ServID)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.ServiceFullName)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.H_Number)
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.H_Date)

                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ServID)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.ServiceFullName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.H_Number)
                    </td>
                </tr>
            }
        </tbody>

    </table>
    <!-- Button trigger modal -->
    <hr />
    <center>
        <button type="button" class="btn btn-primary" id="button">
            พิมพ์รายงาน
        </button>
    </center>
</div>
<!-- Button trigger modal -->


<div id="myModal" class="modal-demo">
    <div class="modal-content">
        <div class="modal-header">
            @ViewBag.Title
        </div>
        <div class="modal-body">
            <div class="row vertical-center-row">
                <center>
                    @Html.MvcReportViewer("Reports/SRCY.rdlc").ProcessingMode(ProcessingMode.Local).ReportParameters(new { year = ViewBag.y }).LocalDataSource("Reportcatagoryyear", Model).Attributes(new { Height = 810, Width =1024 , style = "border: none" })
                </center>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-danger" onclick="Custombox.close();"><i class="fa fa-times"></i>ปิด</button>
        </div>
    </div>
</div>
@section PageScripts{
    <script src="~/Scripts/jquery-2.2.1.js"></script>
    <link href="~/Content/DataTables-1.10.11/media/css/dataTables.bootstrap.css" rel="stylesheet" />
    <link href="~/Content/DataTables-1.10.11/extensions/Responsive/css/responsive.bootstrap.min.css" rel="stylesheet" />
    <script src="~/Scripts/DataTables-1.10.11/media/js/jquery.dataTables.min.js"></script>
    <script src="~/Scripts/DataTables-1.10.11/media/js/dataTables.bootstrap.min.js"></script>
    <script src="~/Scripts/DataTables-1.10.11/extensions/Responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/Scripts/DataTables-1.10.11/extensions/Responsive/js/responsive.bootstrap.min.js"></script>
    <script src="~/assets/js/validation/bootstrapValidator.js"></script>
    <script src="~/assets/js/datetime/bootstrap-timepicker.js"></script>
    <script src="~/assets/js/datetime/bootstrap-datepicker.js"></script>
    <script src="~/assets/js/datetime/bootstrap-datepicker-thai.js"></script>
    <script src="~/assets/js/datetime/locales/bootstrap-datepicker.th.js"></script>
    <script src="~/Scripts/custombox-master/src/js/custombox.js"></script>
    <script src="~/Scripts/custombox-master/src/js/legacy.js"></script>
    <script>

        $(document).ready(function () {
            $("#myModal").hide();
                $(function () {
                    $('#button').on('click', function (e) {
                        Custombox.open({
                            target: '#myModal',
                            effect: 'push',
                            width: '1366',
                            overlayClose:false
                        });
                        e.preventDefault();
                    });
                });


                $('#Rcm').DataTable({
                    "lengthMenu": [[5, 10, 15, 20, 25, 30, -1], [5, 10, 15, 20, 25, 30, "All"]],
                    "ordering": false,
                    "info": false,
                    "bFilter": false,
                    "language": {
                        "lengthMenu": "แสดง _MENU_ รายการต่อหน้า",
                        "zeroRecords": "ไม่พบข้่อมูลที่ต้องการ",
                        "info": "แสดง _PAGE_ ถึง _PAGES_",
                        "infoEmpty": "ไม่มีบันทึกที่สามารถดึงได้"
                    }
                });




            });

            $('#date').datepicker({
            });
            $('#timestart,#timeend').timepicker({

                minuteStep: 1,
                secondStep:1,
                //template: 'modal',
                //appendWidgetTo: 'body',
                showSeconds: true,
                showMeridian: false,
                defaultTime: false

            });

            $('#accountForm').bootstrapValidator({
                // Only disabled elements are excluded
                // The invisible elements belonging to inactive tabs must be validated
                excluded: [':disabled'],
                feedbackIcons: {
                    valid: 'glyphicon glyphicon-ok',
                    invalid: 'glyphicon glyphicon-remove',
                    validating: 'glyphicon glyphicon-refresh'
                },
                submitHandler: function (validator, form, submitButton) {
                    // Do nothing
                },
                fields: {
                    Date: {
                        validators: {
                            notEmpty: {
                                message: 'กรุณาเลือกวันที่ต้องการครับ'
                            }
                        }
                    },
                    timestart: {
                        validators: {
                            notEmpty: {
                                message: 'กรุณาเลือกเวลาเริ่มต้น'
                            }
                        }
                    },
                    timeend: {
                        validators: {
                            notEmpty: {
                                message: 'กรุณาเลือกเวลาสิ้นสุดครับ'
                            }
                        }
                    },
                    ServID: {
                        validators: {
                            notEmpty: {
                                message: 'กรุณาเลือกประเภทบริการครับ'
                            }
                        }
                    }
                }
            });


    </script>
}
